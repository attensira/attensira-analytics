{"version":3,"sources":["../src/index.ts","../src/react.tsx"],"sourcesContent":["const INGEST_URL = 'https://ingest.attensira.com/v1/crawler-logs';\n\n\ntype ServerRequest = {\n  url: string;\n  headers: {\n    get(name: string): string | null;\n    [key: string]: any;\n  };\n};\n\nexport function trackPageHit(\n  projectId: string | null | undefined,\n  request?: ServerRequest\n): void {\n  const isBrowser = typeof window !== 'undefined';\n  \n  // Validate projectId\n  if (!projectId) {\n    if (isBrowser) {\n      console.error('[Attensira Analytics] projectId is required');\n    }\n    return;\n  }\n\n  // Browser-side tracking\n  if (isBrowser) {\n    const href = window.location.href;\n    const payload = JSON.stringify({\n      project_id: projectId,\n      action: 'page_hit',\n      payload: {\n        href,\n        referrer: document.referrer || '',\n        user_agent: navigator.userAgent,\n        locale: navigator.language || '',\n        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || '',\n      },\n    });\n\n    navigator.sendBeacon(INGEST_URL, new Blob([payload], { type: 'application/json' }));\n    return;\n  }\n\n  // Server-side tracking\n  if (request) {\n    const href = request.url;\n    const userAgent = request.headers.get('user-agent') || '';\n    const referer = request.headers.get('referer') || request.headers.get('referrer') || '';\n    const acceptLanguage = request.headers.get('accept-language') || '';\n\n    const payload = JSON.stringify({\n      project_id: projectId,\n      action: 'page_hit',\n      payload: {\n        href,\n        referrer: referer,\n        user_agent: userAgent,\n        locale: acceptLanguage.split(',')[0]?.trim() || '',\n      },\n    });\n\n    // Use fetch for server-side (sendBeacon is browser-only)\n    fetch(INGEST_URL, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: payload,\n    }).catch((error) => {\n      console.error('[Attensira Analytics] Failed to send page hit:', error);\n    });\n  }\n}\n\nexport { AttensiraAnalytics, type AttensiraProps } from './react';\nexport { AttensiraAnalytics as default } from './react';\n","import { useEffect } from 'react';\nimport { trackPageHit } from './index';\n\nexport type AttensiraProps = {\n  projectId: string;\n};\n\n/**\n * React component for tracking page hits with Attensira Analytics.\n * \n * This component only tracks in the browser. During server-side rendering,\n * it will safely do nothing. For server-side tracking (e.g., crawler logs),\n * call trackPageHit() directly in your server code with a request object.\n */\nexport function AttensiraAnalytics({ projectId }: AttensiraProps) {\n  useEffect(() => {\n    // Only track in the browser (not during SSR)\n    if (typeof window === 'undefined') return;\n    \n    trackPageHit(projectId);\n  }, [projectId]);\n\n  return null;\n}\n\nexport default AttensiraAnalytics;\n"],"mappings":"yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,wBAAAE,EAAA,YAAAA,EAAA,iBAAAC,IAAA,eAAAC,EAAAJ,GCAA,IAAAK,EAA0B,iBAcnB,SAASC,EAAmB,CAAE,UAAAC,CAAU,EAAmB,CAChE,sBAAU,IAAM,CAEV,OAAO,QAAW,aAEtBC,EAAaD,CAAS,CACxB,EAAG,CAACA,CAAS,CAAC,EAEP,IACT,CDvBA,IAAME,EAAa,+CAWZ,SAASC,EACdC,EACAC,EACM,CAdR,IAAAC,EAeE,IAAMC,EAAY,OAAO,QAAW,YAGpC,GAAI,CAACH,EAAW,CACVG,GACF,QAAQ,MAAM,6CAA6C,EAE7D,MACF,CAGA,GAAIA,EAAW,CACb,IAAMC,EAAO,OAAO,SAAS,KACvBC,EAAU,KAAK,UAAU,CAC7B,WAAYL,EACZ,OAAQ,WACR,QAAS,CACP,KAAAI,EACA,SAAU,SAAS,UAAY,GAC/B,WAAY,UAAU,UACtB,OAAQ,UAAU,UAAY,GAC9B,SAAU,KAAK,eAAe,EAAE,gBAAgB,EAAE,UAAY,EAChE,CACF,CAAC,EAED,UAAU,WAAWN,EAAY,IAAI,KAAK,CAACO,CAAO,EAAG,CAAE,KAAM,kBAAmB,CAAC,CAAC,EAClF,MACF,CAGA,GAAIJ,EAAS,CACX,IAAMG,EAAOH,EAAQ,IACfK,EAAYL,EAAQ,QAAQ,IAAI,YAAY,GAAK,GACjDM,EAAUN,EAAQ,QAAQ,IAAI,SAAS,GAAKA,EAAQ,QAAQ,IAAI,UAAU,GAAK,GAC/EO,EAAiBP,EAAQ,QAAQ,IAAI,iBAAiB,GAAK,GAE3DI,EAAU,KAAK,UAAU,CAC7B,WAAYL,EACZ,OAAQ,WACR,QAAS,CACP,KAAAI,EACA,SAAUG,EACV,WAAYD,EACZ,SAAQJ,EAAAM,EAAe,MAAM,GAAG,EAAE,CAAC,IAA3B,YAAAN,EAA8B,SAAU,EAClD,CACF,CAAC,EAGD,MAAMJ,EAAY,CAChB,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAMO,CACR,CAAC,EAAE,MAAOI,GAAU,CAClB,QAAQ,MAAM,iDAAkDA,CAAK,CACvE,CAAC,CACH,CACF","names":["src_exports","__export","AttensiraAnalytics","trackPageHit","__toCommonJS","import_react","AttensiraAnalytics","projectId","trackPageHit","INGEST_URL","trackPageHit","projectId","request","_a","isBrowser","href","payload","userAgent","referer","acceptLanguage","error"]}